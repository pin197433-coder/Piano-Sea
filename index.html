<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title id="pageTitle">é’¢ç´æµ· Piano Sea - å¬è§æµ·æ´‹çš„å‘¼å¸</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --ocean-deep: #0f172a;
            --ocean-mid: #1e3a8a;
            --ocean-light: #3b82f6;
            --piano-black: #0a0a0a;
            --piano-white: #f8fafc;
            --sand-gold: #fbbf24;
            --foam: rgba(255,255,255,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(180deg, #0f172a 0%, #1e3a8a 40%, #0c4a6e 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            position: relative;
        }

        /* æµ·æµªåŠ¨ç”»èƒŒæ™¯ */
        .ocean-waves {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }

        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 120' preserveAspectRatio='none'%3E%3Cpath d='M0,60 C150,120 350,0 600,60 C850,120 1050,0 1200,60 L1200,120 L0,120 Z' fill='rgba(255,255,255,0.03)'/%3E%3C/svg%3E");
            background-size: 50% 100%;
            animation: wave 20s linear infinite;
        }

        .wave:nth-child(2) {
            bottom: 10px;
            opacity: 0.5;
            animation: wave 15s linear infinite reverse;
        }

        .wave:nth-child(3) {
            bottom: 20px;
            opacity: 0.3;
            animation: wave 25s linear infinite;
        }

        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* é’¢ç´é”®LogoåŠ¨ç”» */
        .logo-container {
            text-align: center;
            padding: 40px 20px 20px;
            position: relative;
            z-index: 1;
        }

        .piano-logo {
            display: inline-flex;
            align-items: flex-end;
            height: 60px;
            margin-bottom: 15px;
            position: relative;
        }

        .piano-key {
            width: 12px;
            height: 40px;
            background: linear-gradient(180deg, #fff 0%, #e2e8f0 100%);
            margin: 0 2px;
            border-radius: 2px;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            animation: keyWave 3s ease-in-out infinite;
        }

        .piano-key.black {
            background: linear-gradient(180deg, #1a1a1a 0%, #000 100%);
            height: 25px;
            position: absolute;
            width: 8px;
            z-index: 2;
        }

        .piano-key:nth-child(1) { animation-delay: 0s; }
        .piano-key:nth-child(2) { animation-delay: 0.2s; }
        .piano-key:nth-child(3) { animation-delay: 0.4s; }
        .piano-key:nth-child(4) { animation-delay: 0.6s; }
        .piano-key:nth-child(5) { animation-delay: 0.8s; }

        @keyframes keyWave {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .wave-line {
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 20px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 20'%3E%3Cpath d='M0,10 Q25,0 50,10 T100,10' fill='none' stroke='rgba(255,255,255,0.5)' stroke-width='2'/%3E%3C/svg%3E");
            background-size: 20px 20px;
            animation: waveFlow 2s linear infinite;
        }

        @keyframes waveFlow {
            0% { background-position-x: 0; }
            100% { background-position-x: 20px; }
        }

        h1 {
            font-size: 2em;
            font-weight: 300;
            letter-spacing: 2px;
            background: linear-gradient(to right, #fff, #94a3b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 0.9em;
            color: #94a3b8;
            letter-spacing: 3px;
        }

        .container { 
            max-width: 100%; 
            padding: 20px; 
            padding-bottom: 240px;
            position: relative;
            z-index: 1;
        }

        /* æç¤ºæ¶ˆæ¯ï¼ˆToastï¼‰ */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(59, 130, 246, 0.5);
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1em;
            z-index: 20000;
            display: none;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            animation: toastIn 0.3s ease;
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translate(-50%, -40%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        .toast.show {
            display: block;
        }

        /* æœ¬å‘¨æµ·åŸŸè®¢é˜… */
        .weekly-ocean {
            background: linear-gradient(135deg, rgba(251,191,36,0.2), rgba(245,158,11,0.1));
            border: 1px solid rgba(251,191,36,0.3);
            border-radius: 16px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            backdrop-filter: blur(10px);
            cursor: pointer;
        }

        .weekly-badge {
            background: #fbbf24;
            color: #0f172a;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: bold;
        }

        .weekly-text {
            flex: 1;
            margin-left: 12px;
        }

        .weekly-title {
            font-size: 0.9em;
            font-weight: 600;
        }

        .weekly-sub {
            font-size: 0.75em;
            opacity: 0.8;
            margin-top: 2px;
        }

        /* è¯­è¨€åˆ‡æ¢ */
        .lang-switcher {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
            padding: 0 10px;
        }

        .lang-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: rgba(59,130,246,0.5);
            border-color: #3b82f6;
            box-shadow: 0 0 10px rgba(59,130,246,0.3);
        }

        /* åœºæ™¯å¡ç‰‡ä¼˜åŒ– */
        .scene-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 12px; 
            margin: 15px 0; 
        }

        .scene-card {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 20px 15px;
            border: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .scene-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }

        .scene-card.active::before {
            transform: translateX(0);
            animation: scanline 2s linear infinite;
        }

        @keyframes scanline {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .scene-card.active { 
            background: rgba(59,130,246,0.2);
            border-color: #3b82f6;
            box-shadow: 0 0 20px rgba(59,130,246,0.3);
            transform: scale(1.02);
        }

        .scene-icon { 
            font-size: 2.5em; 
            margin-bottom: 8px;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
        }

        .scene-title { 
            font-size: 1.1em; 
            font-weight: 600; 
            margin-bottom: 5px;
        }

        .scene-duration { 
            font-size: 0.8em; 
            color: #fbbf24;
            background: rgba(251,191,36,0.1);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
        }

        .instant-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #ef4444;
            color: white;
            font-size: 0.65em;
            padding: 2px 6px;
            border-radius: 10px;
            animation: pulse 2s infinite;
        }

        /* å…è´¹å±‚æç¤º */
        .daily-limit-box {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 12px;
            margin: 15px 0;
            border-left: 4px solid #fbbf24;
            display: none;
        }

        .daily-limit-box.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .limit-title {
            font-size: 0.9em;
            font-weight: 600;
            color: #fbbf24;
            margin-bottom: 4px;
        }

        .limit-text {
            font-size: 0.8em;
            opacity: 0.9;
        }

        /* ç´è°±å¯è§†åŒ– */
        .piano-visualizer {
            background: rgba(0,0,0,0.6);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            display: none;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .piano-visualizer.show {
            display: block;
        }

        .visualizer-title {
            font-size: 0.85em;
            color: #94a3b8;
            margin-bottom: 10px;
            text-align: center;
        }

        .piano-keys {
            display: flex;
            justify-content: center;
            height: 60px;
            position: relative;
        }

        .key {
            width: 8%;
            height: 100%;
            background: linear-gradient(180deg, #f1f5f9 0%, #cbd5e1 100%);
            border: 1px solid #94a3b8;
            border-radius: 0 0 4px 4px;
            position: relative;
            transition: all 0.1s;
        }

        .key.active {
            background: linear-gradient(180deg, #3b82f6 0%, #1d4ed8 100%);
            box-shadow: 0 0 15px #3b82f6;
            transform: translateY(2px);
        }

        .key.black-key {
            width: 5%;
            height: 60%;
            background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
            position: absolute;
            z-index: 2;
            margin-left: -2.5%;
        }

        .key.black-key.active {
            background: linear-gradient(180deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 0 0 10px #f59e0b;
        }

        /* ç¤¾äº¤åˆ†äº« */
        .share-section {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }

        .share-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .share-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .share-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            border: none;
        }

        /* åŒäººæ¨¡å¼å¼¹çª— */
        .dual-mode-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 10001;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .dual-content {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 30px;
            border-radius: 24px;
            max-width: 350px;
            width: 100%;
            border: 1px solid rgba(59,130,246,0.3);
            text-align: center;
        }

        .room-code {
            font-size: 2.5em;
            font-weight: bold;
            letter-spacing: 5px;
            color: #3b82f6;
            margin: 20px 0;
            font-family: monospace;
            text-shadow: 0 0 20px rgba(59,130,246,0.5);
        }

        .sync-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #4ade80;
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* åˆ†äº«å¡ç‰‡é¢„è§ˆ */
        .share-card-preview {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #0ea5e9, #3b82f6);
            width: 300px;
            height: 400px;
            border-radius: 20px;
            padding: 30px;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10002;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .share-card-preview.show {
            display: flex;
        }

        .card-ocean-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .card-stats {
            font-size: 1.2em;
            margin: 20px 0;
            text-align: center;
        }

        .card-time {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .card-qr {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 10px;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0f172a;
            font-size: 0.7em;
            text-align: center;
        }

        /* å…¶ä»–æ ·å¼ */
        .ocean-selector, .timer-selector {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .selector-title {
            font-size: 1em;
            margin-bottom: 10px;
            color: #94a3b8;
        }

        .wave-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
        
        .wave-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 15px 5px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .wave-btn.active {
            background: linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%);
            border-color: #60a5fa;
            box-shadow: 0 0 15px rgba(14,165,233,0.4);
        }

        .timer-options { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        
        .time-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            position: relative;
            transition: all 0.3s;
        }

        .time-btn.active { 
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); 
            border-color: #3b82f6;
        }

        .free-badge {
            position: absolute;
            top: -8px;
            right: -5px;
            background: #4ade80;
            color: #000;
            font-size: 0.6em;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
        }

        .premium-badge {
            position: absolute;
            top: -8px;
            right: -5px;
            background: #fbbf24;
            color: #000;
            font-size: 0.6em;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
        }

        .player-controls {
            background: rgba(15,23,42,0.95);
            backdrop-filter: blur(20px);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 1000;
        }

        .guide-section {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }

        .status-box {
            background: rgba(255,255,255,0.05);
            border-left: 4px solid #3b82f6;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: left;
            font-size: 0.95em;
        }

        .play-btn-main {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            color: white;
            padding: 15px 50px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(59,130,246,0.4);
            transition: all 0.3s;
        }

        .play-btn-main:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 25px rgba(59,130,246,0.6);
        }

        .play-btn-main:active {
            transform: translateY(0);
        }

        .timer-big { font-size: 3em; text-align: center; margin-bottom: 15px; font-weight: 300; letter-spacing: 2px; font-family: monospace; }

        .controls-row { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 15px; }

        .btn-circle {
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
        }

        .btn-circle:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1);
        }

        .btn-play-big {
            width: 70px; height: 70px; border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            color: white;
            font-size: 1.8em;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(59,130,246,0.5);
            transition: all 0.3s;
        }

        .btn-play-big:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(59,130,246,0.7);
        }

        .volume-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .vol-item { text-align: center; }
        .vol-label { font-size: 0.85em; margin-bottom: 5px; }

        input[type="range"] {
            width: 100%; height: 6px; border-radius: 3px;
            background: rgba(255,255,255,0.2);
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px; height: 18px; border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(59,130,246,0.5);
        }

        .premium-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .premium-content {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            padding: 30px;
            border-radius: 20px;
            max-width: 400px;
            width: 100%;
            border: 1px solid rgba(59,130,246,0.3);
        }

        .premium-title { 
            font-size: 1.6em; margin-bottom: 10px; text-align: center;
            background: linear-gradient(to right, #fbbf24, #f59e0b);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .price-cards { display: flex; flex-direction: column; gap: 12px; margin: 20px 0; }
        
        .price-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
        }

        .price-card:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        .price-card.recommended { border-color: #fbbf24; }
        .price-tag { position: absolute; top: -10px; right: 10px; background: #ef4444; color: white; font-size: 0.7em; padding: 3px 8px; border-radius: 10px; }
        .price-amount { font-size: 1.8em; font-weight: bold; color: #fbbf24; }
        .btn-close-modal { width: 100%; background: transparent; color: white; border: 1px solid rgba(255,255,255,0.3); padding: 12px; border-radius: 10px; cursor: pointer; margin-top: 15px; transition: all 0.3s; }
        
        .btn-close-modal:hover {
            background: rgba(255,255,255,0.1);
        }

        #feedback-btn {
            position: fixed;
            bottom: 200px;
            right: 20px;
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            font-size: 24px;
            z-index: 9999;
            box-shadow: 0 0 20px rgba(59,130,246,0.5);
            animation: pulse 2s infinite;
            cursor: pointer;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(59,130,246,0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px rgba(59,130,246,0.8); }
        }

        @media (max-width: 480px) {
            h1 { font-size: 1.5em; }
            .lang-btn { padding: 6px 10px; font-size: 0.75em; }
            .scene-grid { gap: 8px; }
            .scene-card { padding: 15px 10px; }
        }
    </style>
</head>
<body>
    <!-- æç¤ºæ¶ˆæ¯ -->
    <div class="toast" id="toast"></div>

    <!-- æµ·æµªåŠ¨ç”»èƒŒæ™¯ -->
    <div class="ocean-waves">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <div class="container">
        <!-- LogoåŒºåŸŸ -->
        <div class="logo-container">
            <div class="piano-logo">
                <div class="piano-key"></div>
                <div class="piano-key black" style="left: 10px;"></div>
                <div class="piano-key"></div>
                <div class="piano-key black" style="left: 26px;"></div>
                <div class="piano-key"></div>
                <div class="piano-key"></div>
                <div class="piano-key black" style="left: 58px;"></div>
                <div class="piano-key"></div>
                <div class="piano-key black" style="left: 74px;"></div>
                <div class="piano-key"></div>
                <div class="piano-key black" style="left: 90px;"></div>
                <div class="piano-key"></div>
                <div class="wave-line"></div>
            </div>
            <h1 id="mainTitle">é’¢ç´æµ· <span style="font-size: 0.6em; opacity: 0.7;">Piano Sea</span></h1>
            <p class="subtitle" id="subTitle">å¬è§æµ·æ´‹çš„å‘¼å¸</p>
        </div>

        <!-- æœ¬å‘¨æµ·åŸŸè®¢é˜… -->
        <div class="weekly-ocean" onclick="showWeeklyDetail()">
            <div class="weekly-badge">æœ¬å‘¨æ¨è</div>
            <div class="weekly-text">
                <div class="weekly-title" id="weeklyTitle">ğŸï¸ çˆ±ç´æµ·é’¢ç´</div>
                <div class="weekly-sub" id="weeklySub">å‡çº§VIPè§£é”ä¸“å±æµ·åŸŸä¸ç´è°±å¯è§†åŒ–</div>
            </div>
            <div style="font-size: 1.5em;">â†’</div>
        </div>

        <!-- æ¯æ—¥é™åˆ¶æç¤º -->
        <div class="daily-limit-box" id="dailyLimitBox">
            <div class="limit-title">ğŸµ ä»Šæ—¥å…è´¹æ›²ç›®å·²ç”¨å®Œ</div>
            <div class="limit-text">æ˜æ—¥å†æ¥æˆ–å‡çº§VIPè§£é”å…¨éƒ¨12é¦–é’¢ç´æ›²ä¸ç´è°±å¯è§†åŒ–</div>
        </div>

        <!-- è¯­è¨€åˆ‡æ¢ -->
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="changeLang('zh')">ğŸ‡¨ğŸ‡³ æ™®é€šè¯</button>
            <button class="lang-btn" onclick="changeLang('hk')">ğŸ‡­ğŸ‡° ç²¤è¯­</button>
            <button class="lang-btn" onclick="changeLang('en')">ğŸ‡¬ğŸ‡§ English</button>
            <button class="lang-btn" onclick="changeLang('es')">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
            <button class="lang-btn" onclick="changeLang('ar')">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        </div>

        <!-- æµ·åŸŸé€‰æ‹© -->
        <div class="ocean-selector">
            <div class="selector-title" id="oceanSelectorTitle">ğŸŒŠ é€‰æ‹©æµ·åŸŸé£æ ¼</div>
            <div class="wave-options">
                <button class="wave-btn active" onclick="selectOcean('mediterranean')">
                    <span style="font-size: 2em;">ğŸŒ…</span>
                    <div style="font-size: 0.9em; margin-top: 5px;" id="ocean1Name">åœ°ä¸­æµ·</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('atlantic')">
                    <span style="font-size: 2em;">ğŸŒŠ</span>
                    <div style="font-size: 0.9em; margin-top: 5px;" id="ocean2Name">å¤§è¥¿æ´‹</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('pacific')">
                    <span style="font-size: 2em;">ğŸï¸</span>
                    <div style="font-size: 0.9em; margin-top: 5px;" id="ocean3Name">å¤ªå¹³æ´‹</div>
                </button>
            </div>
        </div>

        <!-- æ—¶æ®µé€‰æ‹© -->
        <div class="timer-selector">
            <div class="selector-title" id="timerTitle">â±ï¸ é€‰æ‹©æ”¾æ¾æ—¶é•¿</div>
            <div class="timer-options">
                <button class="time-btn active" onclick="selectTimer(15, false)">
                    <span id="min15">15åˆ†é’Ÿ</span>
                    <span class="free-badge" id="freeBadge">å…è´¹</span>
                </button>
                <button class="time-btn" onclick="selectTimer(30, true)">
                    <span id="min30">30åˆ†é’Ÿ</span>
                    <span class="premium-badge">VIP</span>
                </button>
                <button class="time-btn" onclick="selectTimer(60, true)">
                    <span id="min60">60åˆ†é’Ÿ</span>
                    <span class="premium-badge">VIP</span>
                </button>
            </div>
        </div>

        <!-- åœºæ™¯é€‰æ‹© -->
        <div class="scene-grid">
            <div class="scene-card active" onclick="selectScene('anxiety')">
                <span class="instant-badge" id="instantBadge1">å³æ—¶</span>
                <div class="scene-icon">ğŸ§˜</div>
                <div class="scene-title" id="scene1Name">ç„¦è™‘æ€¥æ•‘</div>
                <div class="scene-duration" id="scene1Duration">2-3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('focus')">
                <span class="instant-badge" style="display: none;" id="instantBadge2">å³æ—¶</span>
                <div class="scene-icon">ğŸ¯</div>
                <div class="scene-title" id="scene2Name">é™å¿ƒä¸“æ³¨</div>
                <div class="scene-duration" id="scene2Duration">1åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('sleep')">
                <span class="instant-badge" style="display: none;" id="instantBadge3">å³æ—¶</span>
                <div class="scene-icon">ğŸŒ™</div>
                <div class="scene-title" id="scene3Name">ç¡å‰åŠ©çœ </div>
                <div class="scene-duration" id="scene3Duration">3-5åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('nap')">
                <span class="instant-badge" style="display: none;" id="instantBadge4">å³æ—¶</span>
                <div class="scene-icon">ğŸ˜´</div>
                <div class="scene-title" id="scene4Name">åˆä¼‘å°æ†©</div>
                <div class="scene-duration" id="scene4Duration">3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
        </div>

        <!-- ç´è°±å¯è§†åŒ– -->
        <div class="piano-visualizer" id="pianoVisualizer">
            <div class="visualizer-title" id="vizTitle">ğŸ¹ VIPç´è°±å¯è§†åŒ– - å®æ—¶æ¼”å¥</div>
            <div class="piano-keys" id="pianoKeys"></div>
        </div>

        <!-- ç¤¾äº¤åˆ†äº«æŒ‰é’® -->
        <div class="share-section">
            <button class="share-btn primary" onclick="generateShareCard()">
                <span>ğŸ“¸</span> <span id="shareBtnText">ç”Ÿæˆåˆ†äº«å¡ç‰‡</span>
            </button>
            <button class="share-btn" onclick="openDualMode()">
                <span>ğŸ‘¥</span> <span id="dualBtnText">åŒäººæ¨¡å¼</span>
            </button>
        </div>

        <!-- æ’­æ”¾æ§åˆ¶ -->
        <div class="guide-section">
            <div class="status-box" id="statusBox">
                <div id="currentStatus">å½“å‰ï¼šåœ°ä¸­æµ· + ç„¦è™‘æ€¥æ•‘ + æ™®é€šè¯ + 15åˆ†é’Ÿï¼ˆå…è´¹ï¼‰</div>
            </div>
            <div class="now-playing" id="nowPlaying" style="display:none; font-size: 0.9em; color: #60a5fa; margin-bottom: 10px;">
                ğŸµ <span id="trackInfo">æ­£åœ¨åŠ è½½...</span>
            </div>
            <button class="play-btn-main" id="mainPlayBtn" onclick="toggleMainPlay()">
                <span id="startBtnText">â–¶ï¸ å¼€å§‹æ”¾æ¾</span>
            </button>
        </div>
    </div>

    <!-- åº•éƒ¨æ’­æ”¾å™¨ -->
    <div class="player-controls">
        <div class="timer-big" id="timerDisplay">15:00</div>
        <div class="controls-row">
            <button class="btn-circle" onclick="stopAll()" title="åœæ­¢">â¹</button>
            <button class="btn-play-big" id="playPauseBtn" onclick="togglePlay()">â–¶</button>
            <button class="btn-circle" onclick="toggleMute()" title="é™éŸ³" id="muteBtn">ğŸ”Š</button>
        </div>
        <div class="volume-grid">
            <div class="vol-item">
                <div class="vol-label" id="volPianoLabel">ğŸ¹ é’¢ç´</div>
                <input type="range" id="volPiano" min="0" max="100" value="60" oninput="updateVolume('piano', this.value)">
            </div>
            <div class="vol-item">
                <div class="vol-label" id="volWaveLabel">ğŸŒŠ æµ·æµª</div>
                <input type="range" id="volWave" min="0" max="100" value="50" oninput="updateVolume('wave', this.value)">
            </div>
            <div class="vol-item">
                <div class="vol-label" id="volVoiceLabel">ğŸ™ï¸ è¯­éŸ³</div>
                <input type="range" id="volVoice" min="0" max="100" value="80" oninput="updateVolume('voice', this.value)">
            </div>
        </div>
    </div>

    <a href="javascript:;" onclick="return openFeedback(event);" id="feedback-btn" title="å®¢æˆ·åé¦ˆ / Feedback">ğŸ’¬</a>

    <!-- VIPå¼¹çª— -->
    <div class="premium-modal" id="premiumModal" onclick="if(event.target === this) closePremium()">
        <div class="premium-content">
            <div class="premium-title" id="vipTitle">ğŸ”“ å‡çº§VIPä¼šå‘˜</div>
            <div style="text-align: center; margin-bottom: 20px; opacity: 0.9;" id="vipSubtitle">è§£é”å®Œæ•´æ”¾æ¾ä½“éªŒ</div>

            <div class="price-cards">
                <div class="price-card" onclick="selectPlan('month')">
                    <div style="font-size: 0.8em; opacity: 0.8;" id="monthlyText">æœˆåº¦ä¼šå‘˜</div>
                    <div><span class="price-amount" id="priceMonth">Â¥18</span><span style="font-size: 0.9em;">/<span id="perMonth">æœˆ</span></span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" id="monthlyDesc">é€‚åˆçŸ­æœŸä½“éªŒ</div>
                </div>

                <div class="price-card recommended" onclick="selectPlan('year')">
                    <span class="price-tag" id="recTag">æ¨è</span>
                    <div style="font-size: 0.8em; opacity: 0.8;" id="yearlyText">å¹´åº¦ä¼šå‘˜</div>
                    <div><span class="price-amount" id="priceYear">Â¥238</span><span style="font-size: 0.9em;">/<span id="perYear">å¹´</span></span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" id="yearlyDesc">ç«‹çœ178å…ƒ</div>
                </div>

                <div class="price-card" onclick="selectPlan('permanent')">
                    <span class="price-tag" id="bestTag">è¶…å€¼</span>
                    <div style="font-size: 0.8em; opacity: 0.8;" id="permanentText">æ°¸ä¹…ä¼šå‘˜</div>
                    <div><span class="price-amount" id="pricePermanent">Â¥498</span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" id="permanentDesc">ä¸€æ¬¡ä»˜è´¹ç»ˆèº«äº«ç”¨</div>
                </div>
            </div>

            <ul style="font-size: 0.85em; margin: 15px 0; padding-left: 20px; line-height: 1.8;">
                <li id="vipFeature1">âœ“ 30/60åˆ†é’Ÿæ·±åº¦æ”¾æ¾</li>
                <li id="vipFeature2">âœ“ å…¨éƒ¨5ç§è¯­è¨€å®Œæ•´ç‰ˆ</li>
                <li id="vipFeature3">âœ“ 3ç§çœŸå®æµ·åŸŸæµ·æµªå£°</li>
                <li id="vipFeature4">âœ“ ç¦»çº¿ä¸‹è½½åŠŸèƒ½</li>
                <li id="vipFeature5">âœ“ æ— å¹¿å‘Šçº¯å‡€ä½“éªŒ</li>
            </ul>

            <button class="btn-close-modal" onclick="closePremium()" id="continueFree">ğŸ‘‹ ç»§ç»­å…è´¹ä½“éªŒ</button>
        </div>
    </div>

    <!-- åŒäººæ¨¡å¼å¼¹çª— -->
    <div class="dual-mode-modal" id="dualModeModal" onclick="if(event.target === this) closeDualMode()">
        <div class="dual-content">
            <h3 style="margin-bottom: 10px; color: #3b82f6;" id="dualTitle">ğŸ‘¥ åŒäººåŒæ­¥æ¨¡å¼</h3>
            <p style="font-size: 0.9em; opacity: 0.8; margin-bottom: 20px;" id="dualDesc">ä¸æœ‹å‹åŒæ­¥è†å¬åŒä¸€ç‰‡æµ·åŸŸ</p>
            
            <div id="dualCreateView">
                <button onclick="createRoom()" style="background: linear-gradient(135deg, #3b82f6, #2563eb); border: none; color: white; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-size: 1em; margin-bottom: 15px;" id="createRoomBtn">
                    åˆ›å»ºæˆ¿é—´
                </button>
                <p style="font-size: 0.8em; opacity: 0.6;" id="joinRoomText">æˆ–è¾“å…¥æœ‹å‹åˆ†äº«çš„æˆ¿é—´ç ï¼š</p>
                <input type="text" id="roomCodeInput" placeholder="è¾“å…¥4ä½æˆ¿é—´ç " maxlength="4" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 10px; border-radius: 8px; width: 150px; text-align: center; font-size: 1.2em; letter-spacing: 5px; margin-top: 10px;">
                <button onclick="joinRoom()" style="display: block; margin: 10px auto; background: transparent; border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 20px; border-radius: 20px; cursor: pointer;" id="joinBtn">åŠ å…¥</button>
            </div>

            <div id="dualActiveView" style="display: none;">
                <div style="background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.3); border-radius: 12px; padding: 15px; margin: 15px 0;">
                    <div style="font-size: 0.8em; opacity: 0.7; margin-bottom: 5px;" id="roomCodeLabel">æˆ¿é—´å·</div>
                    <div class="room-code" id="displayRoomCode">0000</div>
                </div>
                <div class="sync-status">
                    <div class="sync-dot"></div>
                    <span id="syncText">ç­‰å¾…å¯¹æ–¹åŠ å…¥...</span>
                </div>
                <button onclick="closeDualMode()" style="background: transparent; border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 20px; border-radius: 20px; cursor: pointer; margin-top: 15px; font-size: 0.9em;" id="exitBtn">é€€å‡ºæˆ¿é—´</button>
            </div>
        </div>
    </div>

    <!-- åˆ†äº«å¡ç‰‡é¢„è§ˆ -->
    <div class="share-card-preview" id="shareCardPreview">
        <div class="card-ocean-icon" id="cardOceanIcon">ğŸŒ…</div>
        <div class="card-title" id="cardTitle">åœ°ä¸­æµ·ä¸“æ³¨æ—¶åˆ»</div>
        <div class="card-stats" id="cardStats">
            æœ¬å‘¨ç´¯è®¡ä¸“æ³¨<br>
            <div class="card-time" id="cardTime">45<span style="font-size: 0.5em;">åˆ†é’Ÿ</span></div>
        </div>
        <div style="font-size: 0.8em; opacity: 0.9;">é’¢ç´æµ· Piano Sea</div>
        <div class="card-qr" id="cardQR">æ‰«ç ä¸€èµ·å¬æµ·</div>
        <button onclick="closeShareCard()" style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.3); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer;">âœ•</button>
        <button onclick="downloadCard()" style="margin-top: 15px; background: white; color: #0ea5e9; border: none; padding: 10px 30px; border-radius: 20px; font-weight: bold; cursor: pointer;" id="saveCardBtn">ä¿å­˜å›¾ç‰‡</button>
    </div>

    <script>
        // å¤šè¯­è¨€é…ç½®
        const translations = {
            zh: {
                appName: "é’¢ç´æµ·", subtitle: "å¬è§æµ·æ´‹çš„å‘¼å¸",
                weeklyTitle: "ğŸï¸ çˆ±ç´æµ·é’¢ç´", weeklySub: "å‡çº§VIPè§£é”ä¸“å±æµ·åŸŸä¸ç´è°±å¯è§†åŒ–",
                oceanSelector: "ğŸŒŠ é€‰æ‹©æµ·åŸŸé£æ ¼",
                ocean1: "åœ°ä¸­æµ·", ocean2: "å¤§è¥¿æ´‹", ocean3: "å¤ªå¹³æ´‹",
                timerTitle: "â±ï¸ é€‰æ‹©æ”¾æ¾æ—¶é•¿",
                min15: "15åˆ†é’Ÿ", min30: "30åˆ†é’Ÿ", min60: "60åˆ†é’Ÿ", free: "å…è´¹",
                scene1: "ç„¦è™‘æ€¥æ•‘", scene1Duration: "2-3åˆ†é’Ÿè¯­éŸ³",
                scene2: "é™å¿ƒä¸“æ³¨", scene2Duration: "1åˆ†é’Ÿè¯­éŸ³",
                scene3: "ç¡å‰åŠ©çœ ", scene3Duration: "3-5åˆ†é’Ÿè¯­éŸ³",
                scene4: "åˆä¼‘å°æ†©", scene4Duration: "3åˆ†é’Ÿè¯­éŸ³",
                instant: "å³æ—¶",
                currentStatus: "å½“å‰ï¼š{ocean} + {scene} + æ™®é€šè¯ + {timer}åˆ†é’Ÿï¼ˆ{type}ï¼‰",
                startBtn: "â–¶ï¸ å¼€å§‹æ”¾æ¾", pauseBtn: "â¸ï¸ æš‚åœ", continueBtn: "â–¶ï¸ ç»§ç»­",
                volPiano: "ğŸ¹ é’¢ç´", volWave: "ğŸŒŠ æµ·æµª", volVoice: "ğŸ™ï¸ è¯­éŸ³",
                vizTitle: "ğŸ¹ VIPç´è°±å¯è§†åŒ– - å®æ—¶æ¼”å¥",
                shareBtn: "ç”Ÿæˆåˆ†äº«å¡ç‰‡", dualBtn: "åŒäººæ¨¡å¼",
                vipTitle: "ğŸ”“ å‡çº§VIPä¼šå‘˜", vipSubtitle: "è§£é”å®Œæ•´æ”¾æ¾ä½“éªŒ",
                monthly: "æœˆåº¦ä¼šå‘˜", perMonth: "æœˆ", monthlyDesc: "é€‚åˆçŸ­æœŸä½“éªŒ",
                yearly: "å¹´åº¦ä¼šå‘˜", perYear: "å¹´", yearlyDesc: "ç«‹çœ178å…ƒ",
                permanent: "æ°¸ä¹…ä¼šå‘˜", permanentDesc: "ä¸€æ¬¡ä»˜è´¹ç»ˆèº«äº«ç”¨",
                recTag: "æ¨è", bestTag: "è¶…å€¼",
                vipFeature1: "âœ“ 30/60åˆ†é’Ÿæ·±åº¦æ”¾æ¾", vipFeature2: "âœ“ å…¨éƒ¨5ç§è¯­è¨€å®Œæ•´ç‰ˆ",
                vipFeature3: "âœ“ 3ç§çœŸå®æµ·åŸŸæµ·æµªå£°", vipFeature4: "âœ“ ç¦»çº¿ä¸‹è½½åŠŸèƒ½",
                vipFeature5: "âœ“ æ— å¹¿å‘Šçº¯å‡€ä½“éªŒ", continueFree: "ğŸ‘‹ ç»§ç»­å…è´¹ä½“éªŒ",
                priceMonth: "Â¥18", priceYear: "Â¥238", pricePermanent: "Â¥498",
                limitTitle: "ğŸµ ä»Šæ—¥å…è´¹æ›²ç›®å·²ç”¨å®Œ",
                limitText: "æ˜æ—¥å†æ¥æˆ–å‡çº§VIPè§£é”å…¨éƒ¨12é¦–é’¢ç´æ›²ä¸ç´è°±å¯è§†åŒ–",
                dualTitle: "ğŸ‘¥ åŒäººåŒæ­¥æ¨¡å¼", dualDesc: "ä¸æœ‹å‹åŒæ­¥è†å¬åŒä¸€ç‰‡æµ·åŸŸ",
                createRoomBtn: "åˆ›å»ºæˆ¿é—´", joinRoomText: "æˆ–è¾“å…¥æœ‹å‹åˆ†äº«çš„æˆ¿é—´ç ï¼š",
                joinBtn: "åŠ å…¥", roomCodeLabel: "æˆ¿é—´å·", syncText: "ç­‰å¾…å¯¹æ–¹åŠ å…¥...",
                exitBtn: "é€€å‡ºæˆ¿é—´", saveCardBtn: "ä¿å­˜å›¾ç‰‡",
                shareCardTitle: "ä¸“æ³¨æ—¶åˆ»", weekFocus: "æœ¬å‘¨ç´¯è®¡ä¸“æ³¨",
                cardQR: "æ‰«ç ä¸€èµ·å¬æµ·", perMin: "åˆ†é’Ÿ",
                switchScene: "å·²åˆ‡æ¢è‡³ï¼š{scene}", switchOcean: "å·²åˆ‡æ¢è‡³ï¼š{ocean}", switchLang: "å·²åˆ‡æ¢è‡³ï¼š{lang}"
            },
            hk: {
                appName: "é‹¼ç´æµ·", subtitle: "è½è¦‹æµ·æ´‹çš„å‘¼å¸",
                weeklyTitle: "ğŸï¸ æ„›ç´æµ·é‹¼ç´", weeklySub: "å‡ç´šVIPè§£é–å°ˆå±¬æµ·åŸŸèˆ‡ç´è­œå¯è¦–åŒ–",
                oceanSelector: "ğŸŒŠ é¸æ“‡æµ·åŸŸé¢¨æ ¼",
                ocean1: "åœ°ä¸­æµ·", ocean2: "å¤§è¥¿æ´‹", ocean3: "å¤ªå¹³æ´‹",
                timerTitle: "â±ï¸ é¸æ“‡æ”¾é¬†æ™‚é•·",
                min15: "15åˆ†é˜", min30: "30åˆ†é˜", min60: "60åˆ†é˜", free: "å…è²»",
                scene1: "ç„¦æ…®æ€¥æ•‘", scene1Duration: "2-3åˆ†é˜èªéŸ³",
                scene2: "éœå¿ƒå°ˆæ³¨", scene2Duration: "1åˆ†é˜èªéŸ³",
                scene3: "ç¡å‰åŠ©çœ ", scene3Duration: "3-5åˆ†é˜èªéŸ³",
                scene4: "åˆä¼‘å°æ†©", scene3Duration: "3åˆ†é˜èªéŸ³",
                instant: "å³æ™‚",
                currentStatus: "ç•¶å‰ï¼š{ocean} + {scene} + ç²µèª + {timer}åˆ†é˜ï¼ˆ{type}ï¼‰",
                startBtn: "â–¶ï¸ é–‹å§‹æ”¾é¬†", pauseBtn: "â¸ï¸ æš«åœ", continueBtn: "â–¶ï¸ ç¹¼çºŒ",
                volPiano: "ğŸ¹ é‹¼ç´", volWave: "ğŸŒŠ æµ·æµª", volVoice: "ğŸ™ï¸ èªéŸ³",
                vizTitle: "ğŸ¹ VIPç´è­œå¯è¦–åŒ– - å¯¦æ™‚æ¼”å¥",
                shareBtn: "ç”Ÿæˆåˆ†äº«å¡ç‰‡", dualBtn: "é›™äººæ¨¡å¼",
                vipTitle: "ğŸ”“ å‡ç´šVIPæœƒå“¡", vipSubtitle: "è§£é–å®Œæ•´æ”¾é¬†é«”é©—",
                monthly: "æœˆåº¦æœƒå“¡", perMonth: "æœˆ", monthlyDesc: "é©åˆçŸ­æœŸé«”é©—",
                yearly: "å¹´åº¦æœƒå“¡", perYear: "å¹´", yearlyDesc: "ç«‹çœ178å…ƒ",
                permanent: "æ°¸ä¹…æœƒå“¡", permanentDesc: "ä¸€æ¬¡ä»˜è²»çµ‚èº«äº«ç”¨",
                recTag: "æ¨è–¦", bestTag: "è¶…å€¼",
                vipFeature1: "âœ“ 30/60åˆ†é˜æ·±åº¦æ”¾é¬†", vipFeature2: "âœ“ å…¨éƒ¨5ç¨®èªè¨€å®Œæ•´ç‰ˆ",
                vipFeature3: "âœ“ 3ç¨®çœŸå¯¦æµ·åŸŸæµ·æµªè²", vipFeature4: "âœ“ é›¢ç·šä¸‹è¼‰åŠŸèƒ½",
                vipFeature5: "âœ“ ç„¡å»£å‘Šç´”æ·¨é«”é©—", continueFree: "ğŸ‘‹ ç¹¼çºŒå…è²»é«”é©—",
                priceMonth: "Â¥18", priceYear: "Â¥238", pricePermanent: "Â¥498",
                limitTitle: "ğŸµ ä»Šæ—¥å…è²»æ›²ç›®å·²ç”¨å®Œ",
                limitText: "æ˜æ—¥å†ä¾†æˆ–å‡ç´šVIPè§£é–å…¨éƒ¨12é¦–é‹¼ç´æ›²èˆ‡ç´è­œå¯è¦–åŒ–",
                dualTitle: "ğŸ‘¥ é›™äººåŒæ­¥æ¨¡å¼", dualDesc: "èˆ‡æœ‹å‹åŒæ­¥è†è½åŒä¸€ç‰‡æµ·åŸŸ",
                createRoomBtn: "å‰µå»ºæˆ¿é–“", joinRoomText: "æˆ–è¼¸å…¥æœ‹å‹åˆ†äº«çš„æˆ¿é–“ç¢¼ï¼š",
                joinBtn: "åŠ å…¥", roomCodeLabel: "æˆ¿é–“è™Ÿ", syncText: "ç­‰å¾…å°æ–¹åŠ å…¥...",
                exitBtn: "é€€å‡ºæˆ¿é–“", saveCardBtn: "ä¿å­˜åœ–ç‰‡",
                shareCardTitle: "å°ˆæ³¨æ™‚åˆ»", weekFocus: "æœ¬é€±ç´¯è¨ˆå°ˆæ³¨",
                cardQR: "æƒç¢¼ä¸€èµ·è½æµ·", perMin: "åˆ†é˜",
                switchScene: "å·²åˆ‡æ›è‡³ï¼š{scene}", switchOcean: "å·²åˆ‡æ›è‡³ï¼š{ocean}", switchLang: "å·²åˆ‡æ›è‡³ï¼š{lang}"
            },
            en: {
                appName: "Piano Sea", subtitle: "Hear the Ocean's Breath",
                weeklyTitle: "ğŸï¸ Aegean Sea Piano", weeklySub: "Upgrade VIP for exclusive oceans & piano visualization",
                oceanSelector: "ğŸŒŠ Select Ocean Style",
                ocean1: "Mediterranean", ocean2: "Atlantic", ocean3: "Pacific",
                timerTitle: "â±ï¸ Select Duration",
                min15: "15 min", min30: "30 min", min60: "60 min", free: "FREE",
                scene1: "Anxiety Relief", scene1Duration: "2-3 min voice",
                scene2: "Focus", scene2Duration: "1 min voice",
                scene3: "Deep Sleep", scene3Duration: "3-5 min voice",
                scene4: "Power Nap", scene4Duration: "3 min voice",
                instant: "INSTANT",
                currentStatus: "Current: {ocean} + {scene} + English + {timer}min ({type})",
                startBtn: "â–¶ï¸ Start Relaxing", pauseBtn: "â¸ï¸ Pause", continueBtn: "â–¶ï¸ Continue",
                volPiano: "ğŸ¹ Piano", volWave: "ğŸŒŠ Waves", volVoice: "ğŸ™ï¸ Voice",
                vizTitle: "ğŸ¹ VIP Piano Visualization - Live Playing",
                shareBtn: "Generate Share Card", dualBtn: "Dual Mode",
                vipTitle: "ğŸ”“ Upgrade to VIP", vipSubtitle: "Unlock full relaxation experience",
                monthly: "Monthly", perMonth: "mo", monthlyDesc: "Good for short-term",
                yearly: "Yearly", perYear: "yr", yearlyDesc: "Save $12",
                permanent: "Lifetime", permanentDesc: "Pay once, enjoy forever",
                recTag: "REC", bestTag: "BEST",
                vipFeature1: "âœ“ 30/60 min deep relaxation", vipFeature2: "âœ“ All 5 languages complete",
                vipFeature3: "âœ“ 3 real ocean wave sounds", vipFeature4: "âœ“ Offline download",
                vipFeature5: "âœ“ Ad-free experience", continueFree: "ğŸ‘‹ Continue Free Experience",
                priceMonth: "$5", priceYear: "$48", pricePermanent: "$150",
                limitTitle: "ğŸµ Daily Free Tracks Used Up",
                limitText: "Come back tomorrow or upgrade VIP for all 12 piano tracks & visualization",
                dualTitle: "ğŸ‘¥ Dual Sync Mode", dualDesc: "Listen to the same ocean with friends",
                createRoomBtn: "Create Room", joinRoomText: "Or enter friend's room code:",
                joinBtn: "Join", roomCodeLabel: "Room Code", syncText: "Waiting for partner...",
                exitBtn: "Exit Room", saveCardBtn: "Save Image",
                shareCardTitle: "Focus Moment", weekFocus: "Weekly Focus Time",
                cardQR: "Scan to listen together", perMin: "min",
                switchScene: "Switched to: {scene}", switchOcean: "Switched to: {ocean}", switchLang: "Switched to: {lang}"
            },
            es: {
                appName: "Piano Mar", subtitle: "Escucha el Respiro del OcÃ©ano",
                weeklyTitle: "ğŸï¸ Piano del Mar Egeo", weeklySub: "Actualiza a VIP para ocÃ©anos exclusivos y visualizaciÃ³n",
                oceanSelector: "ğŸŒŠ Estilo de OcÃ©ano",
                ocean1: "MediterrÃ¡neo", ocean2: "AtlÃ¡ntico", ocean3: "PacÃ­fico",
                timerTitle: "â±ï¸ DuraciÃ³n",
                min15: "15 min", min30: "30 min", min60: "60 min", free: "GRATIS",
                scene1: "Alivio Ansiedad", scene1Duration: "2-3 min voz",
                scene2: "Enfoque", scene2Duration: "1 min voz",
                scene3: "SueÃ±o Profundo", scene3Duration: "3-5 min voz",
                scene4: "Siesta", scene4Duration: "3 min voz",
                instant: "INSTANT",
                currentStatus: "Actual: {ocean} + {scene} + EspaÃ±ol + {timer}min (Gratis)",
                startBtn: "â–¶ï¸ Empezar", pauseBtn: "â¸ï¸ Pausa", continueBtn: "â–¶ï¸ Continuar",
                volPiano: "ğŸ¹ Piano", volWave: "ğŸŒŠ Olas", volVoice: "ğŸ™ï¸ Voz",
                vizTitle: "ğŸ¹ VisualizaciÃ³n VIP - ReproducciÃ³n en Vivo",
                shareBtn: "Generar Tarjeta", dualBtn: "Modo Dual",
                vipTitle: "ğŸ”“ Actualizar a VIP", vipSubtitle: "Desbloquea experiencia completa",
                monthly: "Mensual", perMonth: "mes", monthlyDesc: "Corto plazo",
                yearly: "Anual", perYear: "aÃ±o", yearlyDesc: "Ahorra $12",
                permanent: "Permanente", permanentDesc: "Paga una vez, disfruta siempre",
                recTag: "TOP", bestTag: "MEJOR",
                vipFeature1: "âœ“ RelajaciÃ³n 30/60 min", vipFeature2: "âœ“ 5 idiomas completos",
                vipFeature3: "âœ“ 3 sonidos de olas reales", vipFeature4: "âœ“ Descarga offline",
                vipFeature5: "âœ“ Sin anuncios", continueFree: "ğŸ‘‹ Continuar Gratis",
                priceMonth: "$5", priceYear: "$48", pricePermanent: "$150",
                limitTitle: "ğŸµ Pistas Gratuitas Agotadas",
                limitText: "Vuelve maÃ±ana o actualiza a VIP para 12 pistas y visualizaciÃ³n",
                dualTitle: "ğŸ‘¥ Modo Sincronizado", dualDesc: "Escucha el mismo ocÃ©ano con amigos",
                createRoomBtn: "Crear Sala", joinRoomText: "O introduce cÃ³digo de sala:",
                joinBtn: "Unirse", roomCodeLabel: "CÃ³digo", syncText: "Esperando compaÃ±ero...",
                exitBtn: "Salir", saveCardBtn: "Guardar Imagen",
                shareCardTitle: "Momento de Enfoque", weekFocus: "Tiempo Semanal",
                cardQR: "Escanea para escuchar juntos", perMin: "min",
                switchScene: "Cambiado a: {scene}", switchOcean: "Cambiado a: {ocean}", switchLang: "Cambiado a: {lang}"
            },
            ar: {
                appName: "Ø¨ÙŠØ§Ù†Ùˆ Ø³ÙŠ", subtitle: "Ø§Ø³ØªÙ…Ø¹ Ø¥Ù„Ù‰ Ø£Ù†ÙØ§Ø³ Ø§Ù„Ù…Ø­ÙŠØ·",
                weeklyTitle: "ğŸï¸ Ø¨ÙŠØ§Ù†Ùˆ Ø¨Ø­Ø± Ø¥ÙŠØ¬Ø©", weeklySub: "Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ VIP Ù„ÙØªØ­ Ø§Ù„Ù…Ø­ÙŠØ·Ø§Øª Ø§Ù„Ø­ØµØ±ÙŠØ© ÙˆØ§Ù„ØªØµÙˆØ±",
                oceanSelector: "ğŸŒŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙŠØ·",
                ocean1: "Ø§Ù„Ù…ØªÙˆØ³Ø·", ocean2: "Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ", ocean3: "Ø§Ù„Ù‡Ø§Ø¯Ø¦",
                timerTitle: "â±ï¸ Ø§Ù„Ù…Ø¯Ø©",
                min15: "15 Ø¯", min30: "30 Ø¯", min60: "60 Ø¯", free: "Ù…Ø¬Ø§Ù†ÙŠ",
                scene1: "ØªØ®ÙÙŠÙ Ø§Ù„Ù‚Ù„Ù‚", scene1Duration: "2-3 Ø¯ ØµÙˆØª",
                scene2: "ØªØ±ÙƒÙŠØ²", scene2Duration: "1 Ø¯ ØµÙˆØª",
                scene3: "Ù†ÙˆÙ… Ø¹Ù…ÙŠÙ‚", scene3Duration: "3-5 Ø¯ ØµÙˆØª",
                scene4: "Ù‚ÙŠÙ„ÙˆÙ„Ø©", scene4Duration: "3 Ø¯ ØµÙˆØª",
                instant: "ÙÙˆØ±ÙŠ",
                currentStatus: "Ø§Ù„Ø­Ø§Ù„ÙŠ: {ocean} + {scene} + Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© + {timer}Ø¯ (Ù…Ø¬Ø§Ù†ÙŠ)",
                startBtn: "â–¶ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡", pauseBtn: "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª", continueBtn: "â–¶ï¸ Ø§Ø³ØªÙ…Ø±Ø§Ø±",
                volPiano: "ğŸ¹ Ø¨ÙŠØ§Ù†Ùˆ", volWave: "ğŸŒŠ Ø£Ù…ÙˆØ§Ø¬", volVoice: "ğŸ™ï¸ ØµÙˆØª",
                vizTitle: "ğŸ¹ ØªØµÙˆØ± VIP - Ø§Ù„Ø¹Ø²Ù Ø§Ù„Ù…Ø¨Ø§Ø´Ø±",
                shareBtn: "Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø©", dualBtn: "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬",
                vipTitle: "ğŸ”“ ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ VIP", vipSubtitle: "Ø§ÙØªØ­ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡ Ø§Ù„ÙƒØ§Ù…Ù„Ø©",
                monthly: "Ø´Ù‡Ø±ÙŠ", perMonth: "Ø´Ù‡Ø±", monthlyDesc: "Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰",
                yearly: "Ø³Ù†ÙˆÙŠ", perYear: "Ø³Ù†Ø©", yearlyDesc: "ÙˆÙØ± $12",
                permanent: "Ø¯Ø§Ø¦Ù…", permanentDesc: "Ø§Ø¯ÙØ¹ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø§Ø³ØªÙ…ØªØ¹ Ù„Ù„Ø£Ø¨Ø¯",
                recTag: "Ù…ÙˆØµÙ‰ Ø¨Ù‡", bestTag: "Ø§Ù„Ø£ÙØ¶Ù„",
                vipFeature1: "âœ“ Ø§Ø³ØªØ±Ø®Ø§Ø¡ 30/60 Ø¯", vipFeature2: "âœ“ 5 Ù„ØºØ§Øª ÙƒØ§Ù…Ù„Ø©",
                vipFeature3: "âœ“ 3 Ø£ØµÙˆØ§Øª Ø£Ù…ÙˆØ§Ø¬ Ø­Ù‚ÙŠÙ‚ÙŠØ©", vipFeature4: "âœ“ ØªØ­Ù…ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª",
                vipFeature5: "âœ“ Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª", continueFree: "ğŸ‘‹ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¬Ø§Ù†Ø§Ù‹",
                priceMonth: "$5", priceYear: "$48", pricePermanent: "$150",
                limitTitle: "ğŸµ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ø§Ù„ÙŠÙˆÙ…",
                limitText: "Ø¹Ø¯ ØºØ¯Ø§Ù‹ Ø£Ùˆ Ø§Ø±ØªÙ‚Ù Ø¥Ù„Ù‰ VIP Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªØµÙˆØ±",
                dualTitle: "ğŸ‘¥ ÙˆØ¶Ø¹ Ø§Ù„ØªØ²Ø§Ù…Ù†", dualDesc: "Ø§Ø³ØªÙ…Ø¹ Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø­ÙŠØ·",
                createRoomBtn: "Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©", joinRoomText: "Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ©:",
                joinBtn: "Ø§Ù†Ø¶Ù…Ø§Ù…", roomCodeLabel: "Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ©", syncText: "ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø´Ø±ÙŠÙƒ...",
                exitBtn: "Ø®Ø±ÙˆØ¬", saveCardBtn: "Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©",
                shareCardTitle: "Ù„Ø­Ø¸Ø© Ø§Ù„ØªØ±ÙƒÙŠØ²", weekFocus: "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ",
                cardQR: "Ø§Ù…Ø³Ø­ Ù„Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù…Ø¹Ø§Ù‹", perMin: "Ø¯",
                switchScene: "ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰: {scene}", switchOcean: "ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰: {ocean}", switchLang: "ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰: {lang}"
            }
        };

        const audioConfig = {
            oceans: {
                mediterranean: 'audio/wave1.mp3',
                atlantic: 'audio/wave2.mp3',
                pacific: 'audio/wave3.mp3'
            },
            voices: {
                anxiety: { zh: 'audio/ç„¦è™‘æ€¥æ•‘-æ™®é€šè¯.mp3', hk: 'audio/ç„¦è™‘æ€¥æ•‘-ç²¤è¯­.mp3', en: 'audio/ç„¦è™‘æ€¥æ•‘-è‹±è¯­.mp3', es: 'audio/ç„¦è™‘æ€¥æ•‘-è¥¿ç­ç‰™è¯­.mp3', ar: 'audio/ç„¦è™‘æ€¥æ•‘-é˜¿æ‹‰ä¼¯è¯­.mp3' },
                focus: { zh: 'audio/é™å¿ƒä¸“æ³¨-æ™®é€šè¯.mp3', hk: 'audio/é™å¿ƒä¸“æ³¨-ç²¤è¯­.mp3', en: 'audio/é™å¿ƒä¸“æ³¨-è‹±è¯­.mp3', es: 'audio/é™å¿ƒä¸“æ³¨-è¥¿ç­ç‰™è¯­.mp3', ar: 'audio/é™å¿ƒä¸“æ³¨-é˜¿æ‹‰ä¼¯è¯­.mp3' },
                sleep: { zh: 'audio/ç¡å‰åŠ©çœ -æ™®é€šè¯.mp3', hk: 'audio/ç¡å‰åŠ©çœ -ç²¤è¯­.mp3', en: 'audio/ç¡å‰åŠ©çœ -è‹±è¯­.mp3', es: 'audio/ç¡å‰åŠ©çœ -è¥¿ç­ç‰™è¯­.mp3', ar: 'audio/ç¡å‰åŠ©çœ -é˜¿æ‹‰ä¼¯è¯­.mp3' },
                nap: { zh: 'audio/åˆä¼‘å°æ†©-æ™®é€šè¯.mp3', hk: 'audio/åˆä¼‘å°æ†©-ç²¤è¯­.mp3', en: 'audio/åˆä¼‘å°æ†©-è‹±è¯­.mp3', es: 'audio/åˆä¼‘å°æ†©-è¥¿ç­ç‰™è¯­.mp3', ar: 'audio/åˆä¼‘å°æ†©-é˜¿æ‹‰ä¼¯è¯­.mp3' }
            },
            piano: {
                anxiety: ['audio/piano_anxiety BackgroundDocumentary.mp3', 'audio/piano_anxiety CalmWaves.mp3', 'audio/piano_anxiety emotional.mp3'],
                focus: ['audio/piano_focus minimalisticPrelude.mp3', 'audio/piano_focus scarboroughFair.mp3', 'audio/piano_focus variatio14a2clav.mp3'],
                sleep: ['audio/piano_sleep daylight.mp3', 'audio/piano_sleep SoftPiano.mp3', 'audio/piano_sleep SoftPiano2.mp3'],
                nap: ['audio/piano_nap cafeJazz.mp3', 'audio/piano_nap Inspiring.mp3', 'audio/piano_nap morningZen.mp3']
            }
        };

        const weeklyOceans = [
            { name: "ğŸï¸ çˆ±ç´æµ·é’¢ç´", desc: "å¸Œè…Šåœ£æ‰˜é‡Œå°¼çš„è“è‰²æ²»æ„ˆ", week: 1 },
            { name: "ğŸŒŠ åŠ å‹’æ¯”æµ·é’¢ç´", desc: "çƒ­å¸¦é£æš´åçš„å®é™", week: 2 },
            { name: "â„ï¸ åŒ—ææµ·é’¢ç´", desc: "å†°å·ä¸‹çš„æ·±æµ·å›å“", week: 3 },
            { name: "ğŸŒ… çº¢æµ·é’¢ç´", desc: "æ—¥è½æ—¶åˆ†çš„æ¸©æš–æ³¢åŠ¨", week: 4 }
        ];

        let current = { 
            lang: 'zh', 
            scene: 'anxiety', 
            ocean: 'mediterranean', 
            timer: 15,
            isPlaying: false,
            isPaused: false,
            timeLeft: 15 * 60,
            timerInterval: null,
            currentPianoIndex: 0,
            isVip: false,
            dailyPlays: 0,
            roomCode: null,
            totalFocusTime: 0,
            visualizerInterval: null
        };

        let audioPlayers = { piano: null, wave: null, voice: null };

        // åˆå§‹åŒ–
        window.onload = () => {
            initAudio();
            initPianoVisualizer();
            checkDailyLimit();
            updateWeeklyOcean();
            updateStatus();
            updateTimerDisplay();
            loadTotalFocusTime();
        };

        function initAudio() {
            audioPlayers.piano = new Audio();
            audioPlayers.wave = new Audio();
            audioPlayers.voice = new Audio();
            
            audioPlayers.piano.loop = true;
            audioPlayers.wave.loop = true;
            audioPlayers.voice.loop = false;
            
            audioPlayers.piano.volume = 0.6;
            audioPlayers.wave.volume = 0.5;
            audioPlayers.voice.volume = 0.8;

            // è¯­éŸ³æ’­æ”¾å®Œæ¯•åè‡ªåŠ¨é‡æ’­ï¼ˆå¦‚æœéœ€è¦å¾ªç¯ï¼‰
            audioPlayers.voice.addEventListener('ended', () => {
                if(current.isPlaying && !current.isPaused) {
                    audioPlayers.voice.currentTime = 0;
                    audioPlayers.voice.play().catch(e => console.log(e));
                }
            });
        }

        function initPianoVisualizer() {
            const container = document.getElementById('pianoKeys');
            container.innerHTML = '';
            for(let i = 0; i < 14; i++) {
                const key = document.createElement('div');
                key.className = 'key';
                key.id = `key-${i}`;
                container.appendChild(key);
            }
            const positions = [6, 14, 30, 38, 46, 62, 70];
            positions.forEach((pos, idx) => {
                const key = document.createElement('div');
                key.className = 'key black-key';
                key.style.left = pos + '%';
                key.id = `black-key-${idx}`;
                container.appendChild(key);
            });
        }

        function startVisualizer() {
            if(current.visualizerInterval) clearInterval(current.visualizerInterval);
            current.visualizerInterval = setInterval(() => {
                if(current.isVip && current.isPlaying && !current.isPaused) {
                    animatePiano();
                }
            }, 500);
        }

        function stopVisualizer() {
            if(current.visualizerInterval) {
                clearInterval(current.visualizerInterval);
                current.visualizerInterval = null;
            }
        }

        function animatePiano() {
            const randomKey = Math.floor(Math.random() * 14);
            const key = document.getElementById(`key-${randomKey}`);
            if(key) {
                key.classList.add('active');
                setTimeout(() => key.classList.remove('active'), 200);
            }
            if(Math.random() > 0.7) {
                const blackKeyIdx = Math.floor(Math.random() * 7);
                const bKey = document.getElementById(`black-key-${blackKeyIdx}`);
                if(bKey) {
                    bKey.classList.add('active');
                    setTimeout(() => bKey.classList.remove('active'), 150);
                }
            }
        }

        function checkDailyLimit() {
            const today = new Date().toDateString();
            const storedDate = localStorage.getItem('pianoSeaDate');
            if(storedDate !== today) {
                localStorage.setItem('pianoSeaDate', today);
                localStorage.setItem('pianoSeaDaily', '0');
                current.dailyPlays = 0;
            } else {
                current.dailyPlays = parseInt(localStorage.getItem('pianoSeaDaily')) || 0;
            }
            if(current.dailyPlays >= 3 && !current.isVip) {
                document.getElementById('dailyLimitBox').classList.add('show');
            }
        }

        function incrementDailyPlay() {
            if(current.isVip) return;
            current.dailyPlays++;
            localStorage.setItem('pianoSeaDaily', current.dailyPlays);
            if(current.dailyPlays >= 3) {
                document.getElementById('dailyLimitBox').classList.add('show');
            }
        }

        function updateWeeklyOcean() {
            const weekNum = Math.floor(Date.now() / (7 * 24 * 60 * 60 * 1000)) % 4;
            const ocean = weeklyOceans[weekNum];
            const t = translations[current.lang];
            document.getElementById('weeklyTitle').textContent = t.weeklyTitle;
            document.getElementById('weeklySub').textContent = current.isVip ? t.weeklySub.replace("å‡çº§VIPè§£é”", "å·²è§£é”").replace("Upgrade VIP", "Unlocked") : t.weeklySub;
        }

        function showWeeklyDetail() {
            const t = translations[current.lang];
            if(!current.isVip) {
                showToast(t.weeklySub);
                document.getElementById('premiumModal').style.display = 'flex';
            }
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // ã€ä¿®å¤ã€‘è¯­è¨€åˆ‡æ¢ - æ’­æ”¾ä¸­ä¹Ÿå¯æ— ç¼åˆ‡æ¢
        function changeLang(lang) {
            if(current.lang === lang) return;
            
            current.lang = lang;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // æ›´æ–°æ‰€æœ‰UIæ–‡æœ¬
            updateAllUI();
            
            // ã€å…³é”®ä¿®å¤ã€‘å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œæ— ç¼åˆ‡æ¢è¯­éŸ³
            if(current.isPlaying && !current.isPaused) {
                const newVoiceFile = audioConfig.voices[current.scene][current.lang];
                
                // ä¿å­˜å½“å‰æ’­æ”¾è¿›åº¦
                const currentTime = audioPlayers.voice.currentTime;
                
                // åˆ‡æ¢è¯­éŸ³æº
                audioPlayers.voice.src = newVoiceFile;
                audioPlayers.voice.load();
                
                // å°è¯•ä»ç›¸è¿‘ä½ç½®ç»§ç»­æ’­æ”¾ï¼ˆå¦‚æœæ–°è¯­éŸ³é•¿åº¦å…è®¸ï¼‰
                audioPlayers.voice.addEventListener('loadedmetadata', function onLoaded() {
                    if(currentTime < audioPlayers.voice.duration) {
                        audioPlayers.voice.currentTime = currentTime;
                    }
                    audioPlayers.voice.play().catch(e => console.log('è¯­éŸ³åˆ‡æ¢æ’­æ”¾å¤±è´¥:', e));
                    audioPlayers.voice.removeEventListener('loadedmetadata', onLoaded);
                });
                
                // æ˜¾ç¤ºåˆ‡æ¢æç¤º
                const langNames = { zh: 'æ™®é€šè¯', hk: 'ç²¤è¯­', en: 'English', es: 'EspaÃ±ol', ar: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' };
                showToast(translations[lang].switchLang.replace('{lang}', langNames[lang]));
            }
            
            // é˜¿æ‹‰ä¼¯è¯­RTLæ”¯æŒ
            document.body.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        }

        // ã€ä¿®å¤ã€‘åœºæ™¯åˆ‡æ¢ - æ’­æ”¾ä¸­ä¹Ÿå¯æ— ç¼åˆ‡æ¢
        function selectScene(scene) {
            if(current.scene === scene) return;
            
            const oldScene = current.scene;
            current.scene = scene;
            
            // æ›´æ–°UI
            const scenes = ['anxiety', 'focus', 'sleep', 'nap'];
            document.querySelectorAll('.scene-card').forEach((card, idx) => {
                card.classList.toggle('active', scenes[idx] === scene);
                const badge = card.querySelector('.instant-badge');
                if(badge) badge.style.display = idx === 0 ? 'block' : 'none';
            });
            
            // ã€å…³é”®ä¿®å¤ã€‘å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œæ— ç¼åˆ‡æ¢éŸ³é¢‘
            if(current.isPlaying && !current.isPaused) {
                // éšæœºé€‰æ‹©æ–°åœºæ™¯çš„é’¢ç´æ›²
                current.currentPianoIndex = Math.floor(Math.random() * 3);
                const newPianoFile = audioConfig.piano[scene][current.currentPianoIndex];
                const newVoiceFile = audioConfig.voices[scene][current.lang];
                
                // äº¤å‰æ·¡å…¥æ·¡å‡ºæ•ˆæœ
                const fadeOut = setInterval(() => {
                    if(audioPlayers.piano.volume > 0.1) {
                        audioPlayers.piano.volume -= 0.1;
                        audioPlayers.voice.volume -= 0.1;
                    } else {
                        clearInterval(fadeOut);
                        
                        // åˆ‡æ¢æº
                        audioPlayers.piano.src = newPianoFile;
                        audioPlayers.voice.src = newVoiceFile;
                        
                        // æ¢å¤éŸ³é‡å¹¶æ’­æ”¾
                        audioPlayers.piano.load();
                        audioPlayers.voice.load();
                        
                        audioPlayers.piano.play().catch(e => console.log(e));
                        audioPlayers.voice.play().catch(e => console.log(e));
                        
                        // æ¢å¤éŸ³é‡è®¾ç½®
                        const pianoVol = document.getElementById('volPiano').value / 100;
                        const voiceVol = document.getElementById('volVoice').value / 100;
                        
                        let fadeIn = setInterval(() => {
                            if(audioPlayers.piano.volume < pianoVol) {
                                audioPlayers.piano.volume += 0.1;
                            }
                            if(audioPlayers.voice.volume < voiceVol) {
                                audioPlayers.voice.volume += 0.1;
                            }
                            if(audioPlayers.piano.volume >= pianoVol && audioPlayers.voice.volume >= voiceVol) {
                                clearInterval(fadeIn);
                            }
                        }, 50);
                    }
                }, 50);
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('trackInfo').textContent = 
                    `${translations[current.lang]['scene' + (scenes.indexOf(scene) + 1)]} - ${newPianoFile.split('/').pop()}`;
                
                // æ˜¾ç¤ºåˆ‡æ¢æç¤º
                showToast(translations[current.lang].switchScene.replace('{scene}', translations[current.lang]['scene' + (scenes.indexOf(scene) + 1)]));
            } else {
                // æœªæ’­æ”¾æ—¶ä¹Ÿæ›´æ–°é’¢ç´æ›²ç´¢å¼•
                current.currentPianoIndex = Math.floor(Math.random() * 3);
            }
            
            updateStatus();
            
            if(current.isVip) {
                document.getElementById('pianoVisualizer').classList.add('show');
            }
        }

        // ã€ä¿®å¤ã€‘æµ·åŸŸåˆ‡æ¢ - æ’­æ”¾ä¸­ä¹Ÿå¯æ— ç¼åˆ‡æ¢
        function selectOcean(ocean) {
            if(current.ocean === ocean) return;
            
            current.ocean = ocean;
            
            // æ›´æ–°UI
            document.querySelectorAll('.wave-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // ã€å…³é”®ä¿®å¤ã€‘å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œå®æ—¶åˆ‡æ¢æµ·æµªå£°éŸ³
            if(current.isPlaying && !current.isPaused) {
                const newWaveFile = audioConfig.oceans[ocean];
                const oldVolume = audioPlayers.wave.volume;
                
                // æ·¡å‡ºæ—§æµ·æµª
                let fadeOut = setInterval(() => {
                    if(audioPlayers.wave.volume > 0.1) {
                        audioPlayers.wave.volume -= 0.1;
                    } else {
                        clearInterval(fadeOut);
                        
                        // åˆ‡æ¢å¹¶æ’­æ”¾æ–°æµ·æµª
                        audioPlayers.wave.src = newWaveFile;
                        audioPlayers.wave.load();
                        audioPlayers.wave.play().catch(e => console.log(e));
                        
                        // æ·¡å…¥
                        let fadeIn = setInterval(() => {
                            if(audioPlayers.wave.volume < oldVolume) {
                                audioPlayers.wave.volume += 0.1;
                            } else {
                                clearInterval(fadeIn);
                            }
                        }, 50);
                    }
                }, 50);
                
                // æ˜¾ç¤ºåˆ‡æ¢æç¤º
                const oceanNames = { 
                    mediterranean: translations[current.lang].ocean1,
                    atlantic: translations[current.lang].ocean2,
                    pacific: translations[current.lang].ocean3
                };
                showToast(translations[current.lang].switchOcean.replace('{ocean}', oceanNames[ocean]));
            }
            
            updateStatus();
        }

        // ã€ä¿®å¤ã€‘è®¡æ—¶å™¨åˆ‡æ¢ - æ”¯æŒæ’­æ”¾ä¸­åˆ‡æ¢
        function selectTimer(minutes, isPremium) {
            if(isPremium && !current.isVip) {
                document.getElementById('premiumModal').style.display = 'flex';
                return;
            }
            
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.time-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // è®¡ç®—æ—¶é—´å·®
            const oldTime = current.timeLeft;
            current.timer = minutes;
            current.timeLeft = minutes * 60;
            
            // å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œæç¤ºç”¨æˆ·æ—¶é—´å·²æ›´æ–°
            if(current.isPlaying && !current.isPaused) {
                showToast(`${translations[current.lang].timerTitle.replace('â±ï¸ ', '')}: ${minutes}${translations[current.lang].perMin}`);
            }
            
            updateTimerDisplay();
            updateStatus();
        }

        function updateAllUI() {
            const t = translations[current.lang];
            document.getElementById('mainTitle').innerHTML = `${t.appName} <span style="font-size: 0.6em; opacity: 0.7;">${current.lang === 'zh' || current.lang === 'hk' ? 'Piano Sea' : ''}</span>`;
            document.getElementById('subTitle').textContent = t.subtitle;
            document.getElementById('weeklyTitle').textContent = t.weeklyTitle;
            document.getElementById('weeklySub').textContent = current.isVip ? t.weeklySub.replace("å‡çº§VIPè§£é”", "å·²è§£é”").replace("Upgrade VIP", "Unlocked") : t.weeklySub;
            
            document.getElementById('oceanSelectorTitle').textContent = t.oceanSelector;
            document.getElementById('ocean1Name').textContent = t.ocean1;
            document.getElementById('ocean2Name').textContent = t.ocean2;
            document.getElementById('ocean3Name').textContent = t.ocean3;
            
            document.getElementById('timerTitle').textContent = t.timerTitle;
            document.getElementById('min15').textContent = t.min15;
            document.getElementById('min30').textContent = t.min30;
            document.getElementById('min60').textContent = t.min60;
            document.getElementById('freeBadge').textContent = t.free;
            
            document.getElementById('scene1Name').textContent = t.scene1;
            document.getElementById('scene1Duration').textContent = t.scene1Duration;
            document.getElementById('scene2Name').textContent = t.scene2;
            document.getElementById('scene2Duration').textContent = t.scene2Duration;
            document.getElementById('scene3Name').textContent = t.scene3;
            document.getElementById('scene3Duration').textContent = t.scene3Duration;
            document.getElementById('scene4Name').textContent = t.scene4;
            document.getElementById('scene4Duration').textContent = t.scene4Duration;
            
            document.querySelectorAll('.instant-badge').forEach((badge, idx) => {
                badge.textContent = t.instant;
                badge.style.display = idx === 0 ? 'block' : 'none';
            });
            
            document.getElementById('vizTitle').textContent = t.vizTitle;
            document.getElementById('shareBtnText').textContent = t.shareBtn;
            document.getElementById('dualBtnText').textContent = t.dualBtn;
            
            updateStatus();
            updatePlayButtonUI();
            
            // VIPå¼¹çª—
            document.getElementById('vipTitle').textContent = t.vipTitle;
            document.getElementById('vipSubtitle').textContent = t.vipSubtitle;
            document.getElementById('monthlyText').textContent = t.monthly;
            document.getElementById('perMonth').textContent = t.perMonth;
            document.getElementById('monthlyDesc').textContent = t.monthlyDesc;
            document.getElementById('yearlyText').textContent = t.yearly;
            document.getElementById('perYear').textContent = t.perYear;
            document.getElementById('yearlyDesc').textContent = t.yearlyDesc;
            document.getElementById('permanentText').textContent = t.permanent;
            document.getElementById('permanentDesc').textContent = t.permanentDesc;
            document.getElementById('recTag').textContent = t.recTag;
            document.getElementById('bestTag').textContent = t.bestTag;
            document.getElementById('vipFeature1').textContent = t.vipFeature1;
            document.getElementById('vipFeature2').textContent = t.vipFeature2;
            document.getElementById('vipFeature3').textContent = t.vipFeature3;
            document.getElementById('vipFeature4').textContent = t.vipFeature4;
            document.getElementById('vipFeature5').textContent = t.vipFeature5;
            document.getElementById('continueFree').textContent = t.continueFree;
            document.getElementById('priceMonth').textContent = t.priceMonth;
            document.getElementById('priceYear').textContent = t.priceYear;
            document.getElementById('pricePermanent').textContent = t.pricePermanent;
            
            document.querySelector('.limit-title').textContent = t.limitTitle;
            document.querySelector('.limit-text').textContent = t.limitText;
            
            document.getElementById('dualTitle').textContent = t.dualTitle;
            document.getElementById('dualDesc').textContent = t.dualDesc;
            document.getElementById('createRoomBtn').textContent = t.createRoomBtn;
            document.getElementById('joinRoomText').textContent = t.joinRoomText;
            document.getElementById('joinBtn').textContent = t.joinBtn;
            document.getElementById('roomCodeLabel').textContent = t.roomCodeLabel;
            document.getElementById('syncText').textContent = t.syncText;
            document.getElementById('exitBtn').textContent = t.exitBtn;
            document.getElementById('saveCardBtn').textContent = t.saveCardBtn;
            
            document.getElementById('cardQR').textContent = t.cardQR;
            
            document.getElementById('volPianoLabel').textContent = t.volPiano;
            document.getElementById('volWaveLabel').textContent = t.volWave;
            document.getElementById('volVoiceLabel').textContent = t.volVoice;
        }

        function updateStatus() {
            const t = translations[current.lang];
            const oceanNames = { mediterranean: t.ocean1, atlantic: t.ocean2, pacific: t.ocean3 };
            const sceneNames = { anxiety: t.scene1, focus: t.scene2, sleep: t.scene3, nap: t.scene4 };
            const type = current.timer === 15 ? t.free : 'VIP';
            
            let status = t.currentStatus;
            status = status.replace('{ocean}', oceanNames[current.ocean]);
            status = status.replace('{scene}', sceneNames[current.scene]);
            status = status.replace('{timer}', current.timer);
            status = status.replace('{type}', type);
            
            document.getElementById('currentStatus').textContent = status;
        }

        async function toggleMainPlay() {
            if(current.isPlaying) {
                pauseAll();
            } else {
                if(!current.isVip && current.dailyPlays >= 3) {
                    const t = translations[current.lang];
                    showToast(t.limitText);
                    document.getElementById('premiumModal').style.display = 'flex';
                    return;
                }
                await startPlaying();
                incrementDailyPlay();
            }
        }

        async function startPlaying() {
            // è®¾ç½®éŸ³é¢‘æº
            audioPlayers.piano.src = audioConfig.piano[current.scene][current.currentPianoIndex];
            audioPlayers.wave.src = audioConfig.oceans[current.ocean];
            audioPlayers.voice.src = audioConfig.voices[current.scene][current.lang];
            
            current.isPlaying = true;
            current.isPaused = false;
            
            try {
                await Promise.all([
                    audioPlayers.piano.play(),
                    audioPlayers.wave.play(),
                    audioPlayers.voice.play()
                ]);
            } catch(e) {
                console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e);
            }
            
            startTimer();
            startVisualizer();
            updatePlayButtonUI();
            document.getElementById('nowPlaying').style.display = 'block';
            document.getElementById('trackInfo').textContent = 
                `${translations[current.lang].scene1} - ${audioConfig.piano[current.scene][current.currentPianoIndex].split('/').pop()}`;
            
            if(current.isVip) {
                document.getElementById('pianoVisualizer').classList.add('show');
            }
        }

        function pauseAll() {
            Object.values(audioPlayers).forEach(a => a.pause());
            current.isPaused = true;
            clearInterval(current.timerInterval);
            stopVisualizer();
            updatePlayButtonUI();
        }

        function stopAll() {
            Object.values(audioPlayers).forEach(a => { a.pause(); a.currentTime = 0; });
            current.isPlaying = false;
            current.isPaused = false;
            current.timeLeft = current.timer * 60;
            clearInterval(current.timerInterval);
            stopVisualizer();
            updateTimerDisplay();
            updatePlayButtonUI();
            document.getElementById('nowPlaying').style.display = 'none';
            saveFocusTime();
        }

        function startTimer() {
            clearInterval(current.timerInterval);
            current.timerInterval = setInterval(() => {
                if(current.timeLeft > 0) {
                    current.timeLeft--;
                    current.totalFocusTime++;
                    updateTimerDisplay();
                } else {
                    stopAll();
                    showToast(translations[current.lang].startBtn.replace('â–¶ï¸ ', '').replace('å¼€å§‹', 'å®Œæˆ'));
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const m = Math.floor(current.timeLeft / 60).toString().padStart(2, '0');
            const s = (current.timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').textContent = `${m}:${s}`;
        }

        function updatePlayButtonUI() {
            const t = translations[current.lang];
            const btn = document.getElementById('mainPlayBtn');
            const playBtn = document.getElementById('playPauseBtn');
            if(!current.isPlaying) {
                btn.innerHTML = `<span>${t.startBtn}</span>`;
                playBtn.textContent = 'â–¶';
            } else if(current.isPaused) {
                btn.innerHTML = `<span>${t.continueBtn}</span>`;
                playBtn.textContent = 'â–¶';
            } else {
                btn.innerHTML = `<span>${t.pauseBtn}</span>`;
                playBtn.textContent = 'â¸';
            }
        }

        function generateShareCard() {
            const t = translations[current.lang];
            const oceanIcons = { mediterranean: 'ğŸŒ…', atlantic: 'ğŸŒŠ', pacific: 'ğŸï¸' };
            document.getElementById('cardOceanIcon').textContent = oceanIcons[current.ocean];
            document.getElementById('cardTitle').textContent = `${t.ocean1} ${t.shareCardTitle}`;
            document.getElementById('cardStats').innerHTML = `${t.weekFocus}<br><div class="card-time">${current.totalFocusTime}<span style="font-size: 0.5em;">${t.perMin || 'min'}</span></div>`;
            document.getElementById('shareCardPreview').classList.add('show');
        }

        function closeShareCard() {
            document.getElementById('shareCardPreview').classList.remove('show');
        }

        function downloadCard() {
            alert('å›¾ç‰‡å·²ä¿å­˜ï¼');
            closeShareCard();
        }

        function openDualMode() {
            document.getElementById('dualModeModal').style.display = 'flex';
        }

        function closeDualMode() {
            document.getElementById('dualModeModal').style.display = 'none';
        }

        function createRoom() {
            current.roomCode = Math.floor(1000 + Math.random() * 9000).toString();
            document.getElementById('displayRoomCode').textContent = current.roomCode;
            document.getElementById('dualCreateView').style.display = 'none';
            document.getElementById('dualActiveView').style.display = 'block';
        }

        function joinRoom() {
            const code = document.getElementById('roomCodeInput').value;
            if(code.length === 4) {
                current.roomCode = code;
                document.getElementById('displayRoomCode').textContent = code;
                document.getElementById('dualCreateView').style.display = 'none';
                document.getElementById('dualActiveView').style.display = 'block';
                document.getElementById('syncText').textContent = translations[current.lang].syncText;
            }
        }

        function updateVolume(type, value) {
            const vol = value / 100;
            if(audioPlayers[type]) audioPlayers[type].volume = vol;
        }

        function toggleMute() {
            const btn = document.getElementById('muteBtn');
            if(btn.textContent === 'ğŸ”Š') {
                Object.values(audioPlayers).forEach(a => a.muted = true);
                btn.textContent = 'ğŸ”‡';
            } else {
                Object.values(audioPlayers).forEach(a => a.muted = false);
                btn.textContent = 'ğŸ”Š';
            }
        }

        function togglePlay() {
            if(current.isPlaying) {
                if(current.isPaused) resumeAll();
                else pauseAll();
            } else {
                startPlaying();
            }
        }

        function resumeAll() {
            Object.values(audioPlayers).forEach(a => a.play().catch(e => console.log(e)));
            current.isPaused = false;
            startTimer();
            startVisualizer();
            updatePlayButtonUI();
        }

        function openFeedback(e) {
            if(e) { e.preventDefault(); e.stopPropagation(); }
            const links = {
                zh: 'https://wj.qq.com/s2/25778177/fb7d/',
                hk: 'https://wj.qq.com/s2/25778177/fb7d/',
                en: 'https://docs.google.com/forms/d/e/1FAIpQLSc3Rp_lyBrqDgJtwE-rfcVfGDdPBB7oF9MffqonLil_wn5Dhg/viewform',
                es: 'https://docs.google.com/forms/d/e/1FAIpQLSeTsK4__l6-q1TsYYM-DMrgzbfNel9cHrVGW3ymfseWBGRE3A/viewform',
                ar: 'https://docs.google.com/forms/d/e/1FAIpQLSd3JJLlhrHAVEn8W6ivi4ucXIrZd3l_om9SV2mEWJuLTGEPOw/viewform'
            };
            window.open(links[current.lang] || links.zh, '_blank');
            return false;
        }

        function selectPlan(plan) {
            current.isVip = true;
            document.getElementById('dailyLimitBox').classList.remove('show');
            document.getElementById('pianoVisualizer').classList.add('show');
            const t = translations[current.lang];
            document.getElementById('weeklySub').textContent = t.weeklySub.replace("å‡çº§VIPè§£é”", "å·²è§£é”").replace("Upgrade VIP", "Unlocked");
            showToast(`VIP Activated! ${plan} plan`);
            closePremium();
            
            // å¦‚æœæ­£åœ¨æ’­æ”¾ä¸”æ˜¯30/60åˆ†é’Ÿï¼Œç¡®ä¿è®¡æ—¶å™¨æ›´æ–°
            if(current.isPlaying && current.timer === 15) {
                // ä¿æŒå½“å‰æ’­æ”¾ï¼Œä½†ç”¨æˆ·ç°åœ¨å¯ä»¥é€‰æ‹©æ›´é•¿çš„æ—¶é•¿äº†
            }
        }

        function closePremium() {
            document.getElementById('premiumModal').style.display = 'none';
        }

        function loadTotalFocusTime() {
            const saved = localStorage.getItem('pianoSeaTotalTime');
            if(saved) current.totalFocusTime = parseInt(saved);
        }

        function saveFocusTime() {
            localStorage.setItem('pianoSeaTotalTime', current.totalFocusTime);
        }
    </script>
</body>
</html>